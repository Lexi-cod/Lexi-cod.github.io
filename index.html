<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Your Name ‚Äî Adaptive Portfolio</title>
<style>
  :root{
    /* default (will be overridden by mode classes) */
    --bg:#0e1117;
    --text:#e6edf3;
    --muted:rgba(230,237,243,0.78);
    --accent:#58a6ff;
    --glass: rgba(255,255,255,0.04);
    --soft: rgba(126,231,135,0.08);
    --card-radius:14px;
    --transition:400ms cubic-bezier(.2,.9,.25,1);
  }

  /* MODE PALETTES */
  .mode-winter{
    --bg:linear-gradient(180deg,#061026 0%, #09112a 100%);
    --text:#eaf6ff;
    --muted:rgba(234,246,255,0.9);
    --accent:#8fd8ff;
    --glass: rgba(255,255,255,0.04);
    --soft: rgba(143,216,255,0.06);
  }
  .mode-spring{
    --bg: linear-gradient(180deg,#f3fbf6 0%, #e8f9ee 100%);
    --text:#0e2418;
    --muted:rgba(14,36,24,0.75);
    --accent:#7ee787;
    --glass: rgba(255,255,255,0.06);
    --soft: rgba(126,231,135,0.06);
  }
  .mode-summer{
    --bg: linear-gradient(180deg,#fff8e6 0%, #fef3d6 100%);
    --text:#1a1a18;
    --muted:rgba(26,26,24,0.75);
    --accent:#ffbf58;
    --glass: rgba(255,255,255,0.06);
    --soft: rgba(255,191,88,0.06);
  }
  .mode-rainy{
    --bg: linear-gradient(180deg,#0b1014 0%, #0f1620 100%);
    --text:#dfeff6;
    --muted:rgba(223,239,246,0.82);
    --accent:#5fd6e7;
    --glass: rgba(255,255,255,0.03);
    --soft: rgba(95,214,231,0.05);
  }
  .mode-ai{
    --bg: linear-gradient(180deg,#02030a 0%, #071027 100%);
    --text:#dff3ff;
    --muted:rgba(223,243,255,0.85);
    --accent:#6bf;
    --glass: rgba(255,255,255,0.02);
    --soft: rgba(88,166,255,0.06);
  }

  /* base layout */
  html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; background:var(--bg); color:var(--text); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
  .app { min-height:100vh; display:flex; flex-direction:column; }

  header{
    height:100vh; display:flex; align-items:center; justify-content:center; text-align:center; padding:32px; position:relative;
  }
  main{flex:1;}

  /* top control: mode toggle */
  .mode-control{
    position:fixed; right:20px; top:18px; z-index:1200; display:flex; gap:10px; align-items:center;
  }
  .mode-btn{
    background:var(--glass); border:1px solid rgba(255,255,255,0.06); color:var(--muted); padding:9px 12px; border-radius:999px; cursor:pointer; backdrop-filter: blur(8px); transition:var(--transition);
    display:inline-flex; gap:8px; align-items:center; font-size:14px;
  }
  .mode-btn:hover{ transform:translateY(-3px); box-shadow:0 6px 18px rgba(0,0,0,0.25); }
  .mode-panel{ position:fixed; right:20px; top:60px; background:var(--glass); border-radius:12px; padding:10px; display:none; box-shadow:0 10px 30px rgba(0,0,0,0.35); backdrop-filter:blur(10px); }
  .mode-panel.open{ display:block; }
  .mode-item{ padding:8px 12px; border-radius:8px; cursor:pointer; color:var(--text); display:flex; align-items:center; gap:10px; transition:200ms; }
  .mode-item:hover{ background:var(--soft); transform:translateX(6px); }

  /* hero content */
  .hero-card{
    width:min(1100px,95%); border-radius:18px; padding:34px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.04); backdrop-filter:blur(10px);
    display:grid; grid-template-columns: 1fr 360px; gap:28px; align-items:center;
  }
  h1{ font-weight:600; font-size: clamp(26px,4.6vw,40px); margin:0; color:var(--text); line-height:1.05; }
  .sub{ color:var(--muted); margin-top:12px; font-size:16px; max-width:45ch; }

  /* dog container */
  .mascot{
    width:340px; height:240px; display:flex; align-items:center; justify-content:center; position:relative;
    background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005)); border-radius:14px;
    border:1px solid rgba(255,255,255,0.03); padding:12px;
  }
  .mascot svg{ width:100%; height:100%; display:block; }

  /* small UI */
  .controls-row{ margin-top:20px; display:flex; gap:12px; justify-content:center; align-items:center; }
  .cta{ background:var(--accent); color:var(--bg); padding:10px 16px; border-radius:12px; border:none; cursor:pointer; font-weight:600; transition:var(--transition); }
  .cta:hover{ transform:translateY(-4px); }

  /* subtle cards area below hero */
  .panels{ display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:18px; margin-top:26px; }
  .panel{ background:var(--glass); padding:18px; border-radius:12px; border:1px solid rgba(255,255,255,0.03); color:var(--muted); }

  /* simple responsive */
  @media (max-width:920px){
    .hero-card{ grid-template-columns:1fr; }
    .mascot{ order:-1; margin-bottom:10px; height:220px; width:100%; }
  }

  /* background canvas layer */
  #bg-canvas{ position:fixed; inset:0; z-index:-10; pointer-events:none; }

  /* neat transitions for theme changes */
  .app > * { transition: background 500ms ease, color 500ms ease; }
  .hero-card, .panel, .mode-panel{ transition: background 450ms ease, border-color 450ms ease, transform 300ms ease; }

  /* small accessibility focus */
  .mode-item:focus{ outline:2px solid rgba(255,255,255,0.12); outline-offset:3px; }

</style>
</head>
<body>
  <div id="app" class="app">
    <!-- Background canvas -->
    <canvas id="bg-canvas"></canvas>

    <!-- Mode control -->
    <div class="mode-control" aria-label="Mode selector">
      <button id="modeBtn" class="mode-btn" aria-haspopup="true" aria-expanded="false">
        <span id="modeIcon">‚ùÑ</span>
        <span id="modeLabel">Auto</span>
        <svg width="14" height="14" viewBox="0 0 24 24" aria-hidden style="opacity:.8"><path fill="currentColor" d="M7 10l5 5 5-5z"></path></svg>
      </button>
      <div id="modePanel" class="mode-panel" role="menu" aria-hidden="true">
        <div class="mode-item" data-mode="auto" role="menuitem">üåç Auto (season)</div>
        <div class="mode-item" data-mode="winter" role="menuitem">‚ùÑ Winter</div>
        <div class="mode-item" data-mode="spring" role="menuitem">üå∏ Spring</div>
        <div class="mode-item" data-mode="summer" role="menuitem">‚òÄ Summer</div>
        <div class="mode-item" data-mode="rainy" role="menuitem">üåß Rainy</div>
        <div class="mode-item" data-mode="ai" role="menuitem">ü§ñ AI</div>
      </div>
    </div>

    <!-- Header / Hero -->
    <header>
      <div class="hero-card" role="banner">
        <div>
          <h1 id="heroTitle">Designing intelligent, human-first products ‚Äî with a touch of nature.</h1>
          <div class="sub" id="heroSub">I blend AI, UI/UX, photography and music to craft experiences that feel alive. Explore different modes to see the site adapt ‚Äî seasonal palettes, animations, and a friendly mascot.</div>

          <div class="controls-row" aria-hidden>
            <button class="cta" id="enterBtn">Enter portfolio</button>
            <button class="mode-btn" id="manualBtn" title="Toggle manual/auto">Manual</button>
          </div>

          <div class="panels" aria-hidden>
            <div class="panel"><strong>AI & Research</strong><div style="margin-top:8px;color:var(--muted)">Models, prototypes and responsible research.</div></div>
            <div class="panel"><strong>UI / UX</strong><div style="margin-top:8px;color:var(--muted)">Design systems with empathy & clarity.</div></div>
            <div class="panel"><strong>Photography</strong><div style="margin-top:8px;color:var(--muted)">Scenic & nature-focused imagery.</div></div>
          </div>
        </div>

        <div class="mascot" aria-hidden>
          <!-- Soft modern flat dog illustration with multiple state groups -->
          <svg viewBox="0 0 480 320" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" id="dogSvg" role="img" aria-label="Mascot dog">
            <defs>
              <filter id="softShadow" x="-50%" y="-50%" width="200%" height="200%">
                <feDropShadow dx="0" dy="6" stdDeviation="12" flood-color="#000" flood-opacity="0.25"/>
              </filter>
            </defs>

            <!-- winter: dog with scarf, gentle breath -->
            <g id="dog-winter" transform="translate(40,20)" opacity="0">
              <rect x="0" y="0" width="400" height="280" rx="16" fill="transparent"/>
              <!-- ground snow -->
              <ellipse cx="200" cy="240" rx="170" ry="24" fill="#f8feff" opacity="0.06"/>
              <!-- dog body -->
              <g filter="url(#softShadow)" transform="translate(90,60)">
                <ellipse cx="120" cy="110" rx="90" ry="60" fill="#f6e9dd"/>
                <ellipse cx="42" cy="120" rx="36" ry="28" fill="#f6e9dd"/>
                <circle cx="40" cy="80" r="28" fill="#f6e9dd"/>
                <!-- ear -->
                <path d="M14 66 q-18 -8 -10 -30 q12 6 22 12" fill="#e9d7c9"/>
                <!-- face -->
                <circle cx="40" cy="80" r="18" fill="#fff7f0"/>
                <circle cx="34" cy="78" r="3.2" fill="#372a24"/>
                <circle cx="46" cy="78" r="3.2" fill="#372a24"/>
                <path d="M32 92 q8 8 16 0" stroke="#372a24" stroke-width="2" fill="none" stroke-linecap="round"/>
                <!-- scarf -->
                <path d="M20 106 q40 20 72 4 q4 -34 -22 -28 q-24 4 -50 24" fill="#8fd8ff"/>
                <rect x="70" y="118" width="18" height="30" rx="7" fill="#7ec9ff" transform="rotate(-18 79 133)"/>
              </g>
            </g>

            <!-- spring: sniffing dog and petals -->
            <g id="dog-spring" transform="translate(40,20)" opacity="0">
              <ellipse cx="200" cy="240" rx="150" ry="22" fill="#eafdf0" opacity="0.06"/>
              <g filter="url(#softShadow)" transform="translate(80,56)">
                <ellipse cx="120" cy="110" rx="94" ry="62" fill="#fff2e6"/>
                <circle cx="44" cy="80" r="30" fill="#fff2e6"/>
                <path d="M30 66 q-14 -8 -6 -24 q12 6 20 12" fill="#fbe9db"/>
                <circle cx="44" cy="80" r="18" fill="#fffaf2"/>
                <circle cx="38" cy="78" r="3.2" fill="#35241a"/>
                <circle cx="50" cy="78" r="3.2" fill="#35241a"/>
                <path d="M36 96 q6 8 14 0" stroke="#35241a" stroke-width="2" fill="none" stroke-linecap="round"/>
                <!-- flowers near dog -->
                <g transform="translate(10,130)">
                  <circle cx="10" cy="0" r="6" fill="#ffb3c6"/>
                  <circle cx="24" cy="-6" r="5" fill="#ffd7b6"/>
                  <circle cx="42" cy="0" r="5" fill="#c6ffc8"/>
                </g>
              </g>
            </g>

            <!-- summer: playful running dog -->
            <g id="dog-summer" transform="translate(40,20)" opacity="0">
              <ellipse cx="220" cy="250" rx="160" ry="20" fill="#fff7d8" opacity="0.06"/>
              <g filter="url(#softShadow)" transform="translate(60,40)">
                <!-- running pose -->
                <ellipse cx="160" cy="110" rx="84" ry="54" fill="#fff3e8"/>
                <circle cx="40" cy="82" r="26" fill="#fff3e8"/>
                <path d="M20 66 q-16 -8 -6 -22 q10 4 18 10" fill="#fbe7d9"/>
                <circle cx="40" cy="82" r="16" fill="#fffaf5"/>
                <!-- joyful tail -->
                <path d="M240 80 q20 -8 34 6 q-10 -2 -26 6" fill="#ffdcae" opacity="0.9"/>
                <!-- tongue -->
                <path d="M44 94 q8 8 14 2 q-6 0 -14 -2" fill="#ff8aa4"/>
              </g>
            </g>

            <!-- rainy: dog with umbrella -->
            <g id="dog-rainy" transform="translate(40,20)" opacity="0">
              <ellipse cx="200" cy="250" rx="150" ry="22" fill="#dfefff" opacity="0.03"/>
              <g filter="url(#softShadow)" transform="translate(80,56)">
                <ellipse cx="120" cy="110" rx="90" ry="62" fill="#f2f7fb"/>
                <circle cx="44" cy="80" r="30" fill="#f2f7fb"/>
                <circle cx="40" cy="80" r="18" fill="#fff"/>
                <path d="M36 96 q8 8 14 0" stroke="#2b2b2b" stroke-width="2" fill="none" />
                <!-- umbrella -->
                <g transform="translate(160,-20)">
                  <path d="M-40 60 q40 -80 80 0 z" fill="#6fd8dd" stroke="#4fc7cc" stroke-width="2"/>
                  <rect x="-10" y="60" width="6" height="60" rx="3" fill="#333" />
                </g>
                <!-- puddle -->
                <ellipse cx="120" cy="180" rx="60" ry="8" fill="#0d2430" opacity="0.06"/>
              </g>
            </g>

            <!-- ai: dog with futuristic glasses -->
            <g id="dog-ai" transform="translate(40,20)" opacity="0">
              <rect x="0" y="0" width="400" height="280" rx="16" fill="transparent"/>
              <g filter="url(#softShadow)" transform="translate(80,56)">
                <ellipse cx="120" cy="110" rx="88" ry="58" fill="#e9f4ff"/>
                <circle cx="44" cy="80" r="30" fill="#e9f4ff"/>
                <circle cx="40" cy="80" r="18" fill="#fff"/>
                <!-- glasses -->
                <rect x="18" y="64" width="48" height="22" rx="8" fill="#041927" />
                <rect x="36" y="64" width="48" height="22" rx="8" fill="#041927" transform="translate(12,0)"/>
                <path d="M44 76 q8 6 20 6" stroke="#6bf" stroke-width="2" fill="none"/>
                <!-- LED glow -->
                <circle cx="36" cy="74" r="1.6" fill="#6bf" />
                <circle cx="62" cy="74" r="1.6" fill="#6bf" />
                <!-- small circuit lines -->
                <g transform="translate(170,30)" stroke="#6bf" stroke-width="1.2" stroke-linecap="round">
                  <line x1="0" y1="0" x2="34" y2="10"/>
                  <circle cx="0" cy="0" r="3" fill="#6bf"/>
                  <circle cx="34" cy="10" r="3" fill="#6bf"/>
                </g>
              </g>
            </g>

          </svg>
        </div>
      </div>
    </header>

    <main>
      <!-- placeholder for the rest of the site -->
      <section style="padding:48px 8%; color:var(--muted);">
        <h2 style="color:var(--accent)">Quick note</h2>
        <p>Modes change site styling & background animation automatically based on current calendar season (Northern Hemisphere). You can also choose a mode manually with the mode button.</p>
      </section>
    </main>

    <footer style="padding:28px;text-align:center;color:var(--muted)">¬© 2026 Your Name ‚Äî Adaptive Identity Portfolio</footer>
  </div>

<script>
/* ---------- MODE SYSTEM ---------- */
/* modes: auto/winter/spring/summer/rainy/ai
   Season mapping (Northern Hemisphere):
     Dec-Feb => winter
     Mar-May => spring
     Jun-Aug => summer
     Sep-Nov => rainy
*/

const APP = document.getElementById('app');
const modeBtn = document.getElementById('modeBtn');
const modePanel = document.getElementById('modePanel');
const modeLabel = document.getElementById('modeLabel');
const modeIcon = document.getElementById('modeIcon');
const manualBtn = document.getElementById('manualBtn');

let currentMode = null; // 'auto' or specific mode
let activeSeason = null; // 'winter'|'spring'|'summer'|'rainy'|'ai'

const saved = localStorage.getItem('site_mode'); // e.g. 'auto' or 'winter'
const savedManual = localStorage.getItem('site_manual'); // 'true' or 'false'
let useManual = savedManual === 'true' ? true : false;

// determine season by date (northern hemisphere)
function seasonFromDate(d = new Date()){
  const m = d.getMonth() + 1; // 1-12
  if(m === 12 || m <= 2) return 'winter';
  if(m >= 3 && m <= 5) return 'spring';
  if(m >= 6 && m <= 8) return 'summer';
  return 'rainy'; // sep-nov
}

// apply a mode class to root app
function applyMode(mode){
  // remove all mode- classes first
  APP.classList.remove('mode-winter','mode-spring','mode-summer','mode-rainy','mode-ai');

  if(mode === 'auto'){
    // map to season then apply
    const s = seasonFromDate();
    activeSeason = s;
    APP.classList.add('mode-' + s);
    updateUIForMode(s);
  } else {
    activeSeason = mode;
    APP.classList.add('mode-' + mode);
    updateUIForMode(mode);
  }
  currentMode = mode;
  // persist choice
  localStorage.setItem('site_mode', mode);
}

// small UI update (icon + label)
function updateUIForMode(mode){
  const iconMap = {
    'winter':'‚ùÑ', 'spring':'üå∏', 'summer':'‚òÄ', 'rainy':'üåß', 'ai':'ü§ñ','auto':'üåç'
  };
  const labelMap = {
    'winter':'Winter', 'spring':'Spring', 'summer':'Summer', 'rainy':'Rainy', 'ai':'AI Mode', 'auto':'Auto'
  };
  modeIcon.textContent = iconMap[mode] || 'üåç';
  modeLabel.textContent = labelMap[mode] || mode;
  // show/hide dog groups
  setDogState(mode === 'auto' ? seasonFromDate() : mode);
  // swap animations
  startBgForMode(mode === 'auto' ? seasonFromDate() : mode);
}

// toggle panel
modeBtn.addEventListener('click', (e) => {
  const open = modePanel.classList.toggle('open');
  modeBtn.setAttribute('aria-expanded', open ? 'true' : 'false');
  modePanel.setAttribute('aria-hidden', open ? 'false' : 'true');
});

// mode selection clicks
Array.from(document.querySelectorAll('.mode-item')).forEach(el=>{
  el.addEventListener('click', () => {
    const m = el.dataset.mode;
    if(m === 'auto'){
      // toggles to auto
      useManual = false;
      localStorage.setItem('site_manual','false');
      applyMode('auto');
    } else {
      useManual = true;
      localStorage.setItem('site_manual','true');
      applyMode(m);
    }
    // close panel
    modePanel.classList.remove('open');
    modeBtn.setAttribute('aria-expanded', 'false');
    modePanel.setAttribute('aria-hidden', 'true');
  });
});

// manual toggle button (next between auto->manual->auto)
manualBtn.addEventListener('click', () => {
  useManual = !useManual;
  localStorage.setItem('site_manual', String(useManual));
  if(!useManual){
    applyMode('auto');
  } else {
    // if enabling manual and a saved specific mode exists, keep it; otherwise pick current season
    const found = localStorage.getItem('site_mode');
    if(found && found !== 'auto') applyMode(found);
    else {
      // default to AI when user toggles manual on for quick demo
      applyMode('ai');
    }
  }
});

// initialize mode on load
function initMode(){
  const savedMode = saved || 'auto';
  if(savedMode !== 'auto' && (savedManual === 'true' || savedManual === null)){
    // saved a manual mode and user allowed manual
    applyMode(savedMode);
    useManual = true;
  } else {
    // default to auto
    applyMode('auto');
    useManual = false;
  }
  // reflect manual button state
  manualBtn.textContent = useManual ? 'Manual' : 'Auto';
}
initMode();

/* ---------- DOG STATE SWITCH ---------- */
const dogStates = {
  winter: document.getElementById('dog-winter'),
  spring: document.getElementById('dog-spring'),
  summer: document.getElementById('dog-summer'),
  rainy: document.getElementById('dog-rainy'),
  ai: document.getElementById('dog-ai')
};

function setDogState(mode){
  Object.keys(dogStates).forEach(k => {
    const el = dogStates[k];
    if(!el) return;
    if(k === mode){
      el.style.transition = 'opacity 450ms cubic-bezier(.2,.9,.25,1)';
      el.style.opacity = 1;
      el.style.transform = 'translateY(0)';
    } else {
      el.style.transition = 'opacity 350ms ease';
      el.style.opacity = 0;
    }
  });
}

/* ---------- BACKGROUND ANIMATIONS (canvas) ---------- */
const canvas = document.getElementById('bg-canvas');
const ctx = canvas.getContext('2d');
let w = canvas.width = innerWidth;
let h = canvas.height = innerHeight;
let animFrame = null;
let bgMode = null;

// particle arrays
let particles = [];

function resizeCanvas(){
  w = canvas.width = innerWidth;
  h = canvas.height = innerHeight;
}
addEventListener('resize', resizeCanvas);

/* Snow for winter */
function startWinter(){
  particles = [];
  for(let i=0;i<90;i++){
    particles.push({
      x: Math.random()*w,
      y: Math.random()*h,
      r: 0.8 + Math.random()*2.2,
      vy: 0.4 + Math.random()*1.2,
      vx: -0.3 + Math.random()*0.6,
      alpha: 0.6 + Math.random()*0.4
    });
  }
  cancelAnimationFrame(animFrame);
  function loop(){
    ctx.clearRect(0,0,w,h);
    particles.forEach(p=>{
      p.x += p.vx; p.y += p.vy;
      if(p.y > h+10){ p.y = -10; p.x = Math.random()*w; }
      ctx.beginPath();
      ctx.globalAlpha = p.alpha;
      ctx.fillStyle = "#fff";
      ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
      ctx.fill();
    });
    ctx.globalAlpha = 1;
    animFrame = requestAnimationFrame(loop);
  }
  loop();
}

/* Petals for spring */
function startSpring(){
  particles = [];
  for(let i=0;i<80;i++){
    particles.push({
      x: Math.random()*w,
      y: Math.random()*h,
      r: 6 + Math.random()*8,
      vy: 0.6 + Math.random()*0.9,
      angle: Math.random()*Math.PI*2,
      vx: -0.6 + Math.random()*1.2,
      hue: 320 + Math.random()*60
    });
  }
  cancelAnimationFrame(animFrame);
  function loop(){
    ctx.clearRect(0,0,w,h);
    particles.forEach(p=>{
      p.y += p.vy;
      p.x += p.vx + Math.sin(p.angle)*0.4;
      p.angle += 0.02;
      if(p.y > h+20){ p.y = -30; p.x = Math.random()*w; }
      // draw petal as rotated ellipse
      ctx.save();
      ctx.translate(p.x,p.y);
      ctx.rotate(Math.sin(p.angle));
      ctx.beginPath();
      ctx.fillStyle = `hsl(${p.hue},70%,70%)`;
      ctx.ellipse(0,0,p.r*0.6,p.r,0,0,Math.PI*2);
      ctx.fill();
      ctx.restore();
    });
    animFrame = requestAnimationFrame(loop);
  }
  loop();
}

/* Sun beams / shimmer for summer */
function startSummer(){
  particles = [];
  for(let i=0;i<60;i++){
    particles.push({
      x: Math.random()*w,
      y: Math.random()*h*0.6,
      r: 30 + Math.random()*80,
      vy: 0.02 + Math.random()*0.15,
      a: Math.random()*0.2 + 0.06
    });
  }
  cancelAnimationFrame(animFrame);
  function loop(){
    ctx.clearRect(0,0,w,h);
    // soft warm overlay
    ctx.fillStyle = 'rgba(255,238,204,0.03)';
    ctx.fillRect(0,0,w,h);
    particles.forEach(p=>{
      p.y += p.vy;
      if(p.y > h){ p.y = -p.r; p.x = Math.random()*w; }
      const grad = ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r);
      grad.addColorStop(0, `rgba(255,220,130,${p.a})`);
      grad.addColorStop(1, 'rgba(255,220,130,0)');
      ctx.fillStyle = grad;
      ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill();
    });
    animFrame = requestAnimationFrame(loop);
  }
  loop();
}

/* Rain for rainy mode */
function startRainy(){
  particles = [];
  for(let i=0;i<220;i++){
    particles.push({
      x: Math.random()*w,
      y: Math.random()*h,
      l: 10 + Math.random()*18,
      vy: 4 + Math.random()*6,
      alpha: 0.15 + Math.random()*0.25,
      skew: -0.8 - Math.random()*0.6
    });
  }
  cancelAnimationFrame(animFrame);
  function loop(){
    ctx.clearRect(0,0,w,h);
    ctx.fillStyle = 'rgba(10,20,30,0.06)'; ctx.fillRect(0,0,w,h);
    particles.forEach(p=>{
      p.x += p.skew;
      p.y += p.vy;
      if(p.y > h+20){ p.y = -20; p.x = Math.random()*w; }
      ctx.beginPath();
      ctx.strokeStyle = `rgba(190,230,240,${p.alpha})`;
      ctx.lineWidth = 1.2;
      ctx.moveTo(p.x,p.y);
      ctx.lineTo(p.x - p.skew*2, p.y - p.l);
      ctx.stroke();
    });
    animFrame = requestAnimationFrame(loop);
  }
  loop();
}

/* Neural network for AI: nodes + softly connecting lines */
function startAI(){
  // create nodes in a grid
  const cols = Math.max(8, Math.floor(w/120));
  const rows = Math.max(5, Math.floor(h/140));
  const nodes = [];
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      nodes.push({
        x: (c+0.5) * (w/cols) + (Math.random()-0.5)*40,
        y: (r+0.5) * (h/rows) + (Math.random()-0.5)*30,
        r: 2 + Math.random()*3,
        pulse: Math.random()*1.2,
        phase: Math.random()*Math.PI*2
      });
    }
  }
  cancelAnimationFrame(animFrame);
  function loop(t){
    ctx.clearRect(0,0,w,h);
    // dim background
    ctx.fillStyle = 'rgba(5,8,16,0.06)'; ctx.fillRect(0,0,w,h);
    // draw connections probabilistically
    ctx.globalCompositeOperation = 'lighter';
    for(let i=0;i<nodes.length;i++){
      const a = nodes[i];
      for(let j=i+1;j<Math.min(i+8,nodes.length);j++){
        const b = nodes[j];
        const dx = a.x - b.x, dy = a.y - b.y;
        const dist = Math.sqrt(dx*dx+dy*dy);
        if(dist < 180){
          ctx.strokeStyle = `rgba(100,170,255,${1 - dist/180})`;
          ctx.lineWidth = 0.8;
          ctx.beginPath(); ctx.moveTo(a.x,a.y); ctx.lineTo(b.x,b.y); ctx.stroke();
        }
      }
    }
    // draw nodes with pulse
    nodes.forEach(n=>{
      const p = 0.8 + Math.sin(t/600 + n.phase) * 0.2;
      ctx.beginPath();
      const glow = ctx.createRadialGradient(n.x,n.y,0,n.x,n.y,14);
      glow.addColorStop(0, `rgba(120,190,255,${0.12*p})`);
      glow.addColorStop(1, 'rgba(120,190,255,0)');
      ctx.fillStyle = glow;
      ctx.fillRect(n.x-14,n.y-14,28,28);
      ctx.beginPath();
      ctx.fillStyle = `rgba(150,210,255,${0.9*p})`;
      ctx.arc(n.x,n.y, n.r * p + 0.5, 0, Math.PI*2);
      ctx.fill();
    });
    ctx.globalCompositeOperation = 'source-over';
    animFrame = requestAnimationFrame(loop);
  }
  loop(0);
}

/* Start appropriate background for a mode (mode is season name) */
function startBgForMode(mode){
  // avoid restarting if same mode
  if(bgMode === mode) return;
  bgMode = mode;
  switch(mode){
    case 'winter': startWinter(); break;
    case 'spring': startSpring(); break;
    case 'summer': startSummer(); break;
    case 'rainy': startRainy(); break;
    case 'ai': startAI(); break;
    default: startSpring(); break;
  }
}

/* initialize with the activeSeason variable after applyMode() */
startBgForMode(activeSeason || seasonFromDate());

/* sync manual button label and close on outside click */
document.addEventListener('click', (e)=>{
  if(!modePanel.contains(e.target) && !modeBtn.contains(e.target)){
    modePanel.classList.remove('open');
    modeBtn.setAttribute('aria-expanded','false');
  }
});
setInterval(()=>{ manualBtn.textContent = useManual ? 'Manual' : 'Auto'; }, 1000);

/* keep dog in sync if autoswitch (e.g., when date changes) - optional tick every minute */
setInterval(()=>{
  const s = seasonFromDate();
  const modeStored = localStorage.getItem('site_mode');
  const manualStored = localStorage.getItem('site_manual') === 'true';
  if(!manualStored && modeStored === 'auto'){
    applyMode('auto'); // recalculates season and applies
  }
}, 60*1000);

/* small enter button behavior (just demo) */
document.getElementById('enterBtn').addEventListener('click', () => {
  // scroll down to main content
  window.scrollTo({ top: window.innerHeight - 60, behavior:'smooth' });
});

/* Accessibility: keyboard navigation for mode panel */
modePanel.addEventListener('keydown', (e) => {
  if(e.key === 'Escape'){ modePanel.classList.remove('open'); modeBtn.setAttribute('aria-expanded','false'); }
});

</script>
</body>
</html>
